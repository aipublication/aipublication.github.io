---
layout: article
mathjax: true
title: Bayesian Spam Filter
image: "/assets/images/covers/tim-johnson-Vwf8q3RzBRE-unsplash.jpg"
categories:
- DM
desc: It used information from previous emails to mark them as Spam or not. 
imagealt: Cover Image for article
---

It used information from previous emails to mark them as [Spam]({% post_url 2021-07-02-spam %}) or not.

It uses probability of occurrence of a particular word in emails marked as spam and emails not marked as spam.

### Implementing a Bayesian Spam Filter
Let $B$ be a set of emails known to spam and $G$ be a set of email known not to be spam.
































































































































































































































































































































































































Assume, probability of a new email to be spam or not spam is equally likely.

Probability of a word $w$ occurring in set $B$ and $G$ is $p(w) = n_B(w) / |B|$ and $q(w) = n_G(w) / |G|$ respectively.

































































































































































































































































































































































































Let $E$ be the event that email contains word $w$ and $S$ be the event that email is spam.
































































































































































































































































































































































































Then probability of an email to be spam given it contains word $w$ is
































































































































































































































































































































































































$$p(S | E) = {p(E|S)p(S) \over p(E|S)p(S) + p(E|\bar{S})p(\bar{S})}$$

































































































































































































































































































































































































As $p(S) = p(\bar{S}) = 1/2$ (equally likely events).
































































































































































































































































































































































































$$p(S | E) = {p(E|S)p(S) \over p(E|S) + p(E|\bar{S})}$$

































































































































































































































































































































































































Let $r(w)$ represent the probability $p(S|E)$ then
































































































































































































































































































































































































$$r(w) = {p(w) \over {p(w) + q(w)}}$$

































































































































































































































































































































































































For each word $r(w)$ is calculated and if it is greater than some threshold set by us (like 0.9) then emails containing that word are marked as spam.

































































































































































































































































































































































































### Generalized Bayesian Spam Filter
Usually Bayesian spam filters are created with more than one words.
Let $E_i$ be an event of occurrence of word $w_i$ in email such that $E_i | S$ for $i=1, 2, \dots n$ are [Independent Events]({% post_url 2021-06-20-independent-events %}) and $p(S) = p(\bar{S}) = 1/2$.
































































































































































































































































































































































































Then $$r(w_1, w_2, \dots w_n) = {\prod_{i=1}^n p(w_i) \over {\prod_{i=1}^n p(w_i) + \prod_{i=1}^n q(w_i)}}$$

































































































































































































































































































































































































### Performance improvement of Bayesian Filter
* Select words with probability of occurrence in spam to be really high or really low.
* Look for pair of words with really high and really low probability of occurring in spam.
* Analyzing the structure of email gain more knowledge if it is spam or not.

### Subtopics
- [Bayesian Poisoning]({% post_url 2021-07-02-bayesian-poisoning %})

This blog was published directly from my notes.
To check the source of my notes and images used in this blog, visit <a href="/credits.html" target="_blank">Credits</a>.

To read my notes, download this <a href="https://github.com/bovem/CS" target="blank">repository</a>.